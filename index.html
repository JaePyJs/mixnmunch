<!--
  Mix and Munch: Local Filipino Recipe Generator
  Mobile-first redesign with modern UX and tabbed navigation
-->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mix & Munch</title>

    <!-- Google Fonts - Poppins for Recipely Style -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Font Awesome 6 for icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    <!-- Application Styles -->
    <link rel="stylesheet" href="css/mobile-app.css" />
    <link rel="stylesheet" href="css/app-animations.css" />

    <!-- PWA capabilities -->
    <link rel="manifest" href="manifest.json" />
    <link rel="apple-touch-icon" href="images/icons/icon-192x192.png" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />

    <!-- Supabase JS CDN for client-side integration -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  </head>
  <body class="main-app-bg fade-in">
    <div id="landing-view" class="view-container hidden">
      <div class="landing-container">
        <header class="landing-header">
          <img src="images/logo.svg" alt="Mix & Munch Logo" class="landing-logo">
        </header>
        <main class="landing-main">
          <h1 class="landing-title">Welcome to Mix & Munch</h1>
          <p class="landing-desc">Discover and share Filipino recipes. Join our food-loving community!</p>
          <div class="landing-actions">
            <button class="btn-primary" id="landing-btn-signup">Sign Up</button>
            <button class="btn-secondary" id="landing-btn-signin">Sign In</button>
            <button class="btn-tertiary" id="landing-btn-guest">Continue as Guest</button>
          </div>
        </main>
        <footer class="landing-footer">
          <p>&copy; 2025 Mix & Munch</p>
        </footer>
      </div>
      <!-- Auth Modal (originally from landing.html, might be reused or replaced by main app's auth) -->
      <div id="landing-auth-modal" class="modal hidden"> <!-- Renamed id to avoid conflict -->
        <div class="modal-content">
          <button class="modal-close" id="landing-close-auth-modal">&times;</button>
          <form id="landing-auth-form">
            <h2 id="landing-auth-modal-title">Sign Up</h2>
            <input type="email" id="landing-auth-email" placeholder="Email" required autocomplete="email">
            <input type="password" id="landing-auth-password" placeholder="Password" required autocomplete="new-password">
            <button type="submit" class="btn-primary" id="landing-auth-submit">Continue</button>
            <div class="auth-switch">
              <span id="landing-switch-auth-mode">Already have an account? <a href="#" id="landing-switch-to-signin">Sign In</a></span>
            </div>
          </form>
        </div>
      </div>
    </div>
    <div id="app-view" class="mobile-container view-container hidden"> <!-- Added id and classes -->
      <!-- Recipely-style App Header -->
      <header class="app-header">
        <div class="header-left">
          <h1 class="app-title">Mix & Munch</h1>
        </div>
        <div class="header-right">
          <div class="notification-button">
            <i class="far fa-bell"></i>
            <span class="notification-dot"></span>
          </div>
          <div id="user-avatar" class="profile-button">
            <img
              src="https://randomuser.me/api/portraits/women/44.jpg"
              alt="Profile"
            />
          </div>
        </div>
      </header>

      <!-- Main App Content -->
      <main class="app-content">
        <!-- Home Tab Content -->
        <div id="tab-home" class="tab-content active">
          <!-- Home Header Section -->
          <section class="home-header">
            <h2 class="greeting-title">Hi, Mary!</h2>
            <p class="greeting-subtitle">What are you cooking today?</p>

            <!-- Search Bar -->
            <div class="search-container">
              <div class="search-bar">
                <i class="fas fa-search"></i>
                <input type="text" placeholder="Search recipes..." />
              </div>
            </div>
          </section>

          <!-- Featured Recipe -->
          <section class="featured-recipe">
            <div class="featured-recipe-card">
              <div class="featured-image">
                <img
                  src="https://images.unsplash.com/photo-1512058564366-18510be2db19?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=2072&q=80"
                  alt="Featured Recipe"
                />
                <div class="featured-overlay"></div>
                <div class="featured-time">
                  <i class="far fa-clock"></i> 30 min
                </div>
                <div class="featured-bookmark">
                  <i class="far fa-bookmark"></i>
                </div>
              </div>
              <div class="featured-content">
                <div class="featured-category">Filipino</div>
                <h3 class="featured-title">Classic Chicken Adobo</h3>
                <div class="featured-chef">
                  <img
                    src="https://randomuser.me/api/portraits/women/60.jpg"
                    alt="Chef"
                  />
                  <span>By Chef Maria Santos</span>
                </div>
                <div class="featured-stats">
                  <div class="stat">
                    <i class="fas fa-fire"></i>
                    <span>120 Cal</span>
                  </div>
                  <div class="stat-divider"></div>
                  <div class="stat">
                    <i class="fas fa-star"></i>
                    <span>4.8</span>
                  </div>
                  <div class="stat-divider"></div>
                  <div class="stat">
                    <i class="fas fa-users"></i>
                    <span>3-4</span>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <!-- Categories Section -->
          <section class="categories-section">
            <div class="section-header">
              <h3>Categories</h3>
              <a href="#">See All <i class="fas fa-chevron-right"></i></a>
            </div>
            <div class="category-scroll">
              <div class="category-item active">
                <div class="category-icon">
                  <i class="fas fa-utensils"></i>
                </div>
                <span>All</span>
              </div>
              <div class="category-item">
                <div class="category-icon">
                  <i class="fas fa-drumstick-bite"></i>
                </div>
                <span>Meat</span>
              </div>
              <div class="category-item">
                <div class="category-icon">
                  <i class="fas fa-fish"></i>
                </div>
                <span>Seafood</span>
              </div>
              <div class="category-item">
                <div class="category-icon">
                  <i class="fas fa-carrot"></i>
                </div>
                <span>Vegetable</span>
              </div>
              <div class="category-item">
                <div class="category-icon">
                  <i class="fas fa-pepper-hot"></i>
                </div>
                <span>Spicy</span>
              </div>
              <div class="category-item">
                <div class="category-icon">
                  <i class="fas fa-cookie"></i>
                </div>
                <span>Dessert</span>
              </div>
              <div class="category-item">
                <div class="category-icon">
                  <i class="fas fa-glass-cheers"></i>
                </div>
                <span>Drinks</span>
              </div>
            </div>
          </section>

          <!-- Popular Recipes Section -->
          <section class="popular-recipes">
            <div class="section-header">
              <h3>Popular Recipes</h3>
              <a href="#">See All <i class="fas fa-chevron-right"></i></a>
            </div>

            <div class="recipe-grid">
              <div class="recipe-card">
                <div class="recipe-image">
                  <img
                    src="https://salu-salo.com/wp-content/uploads/2015/04/Pork-Sinigang-3.jpg"
                    alt="Pork Sinigang"
                  />
                  <div class="recipe-bookmark">
                    <i class="far fa-bookmark"></i>
                  </div>
                  <div class="recipe-time">45 min</div>
                </div>
                <div class="recipe-content">
                  <h4>Pork Sinigang</h4>
                  <div class="recipe-author">By Chef Anna</div>
                  <div class="recipe-rating">
                    <div class="stars">
                      <i class="fas fa-star"></i>
                      <i class="fas fa-star"></i>
                      <i class="fas fa-star"></i>
                      <i class="fas fa-star"></i>
                      <i class="fas fa-star-half-alt"></i>
                    </div>
                    <span>4.5</span>
                  </div>
                </div>
              </div>

              <div class="recipe-card">
                <div class="recipe-image">
                  <img
                    src="https://www.kawalingpinoy.com/wp-content/uploads/2013/01/filipino-pork-bbq-6.jpg"
                    alt="BBQ Pork Skewers"
                  />
                  <div class="recipe-bookmark">
                    <i class="far fa-bookmark"></i>
                  </div>
                  <div class="recipe-time">35 min</div>
                </div>
                <div class="recipe-content">
                  <h4>BBQ Pork Skewers</h4>
                  <div class="recipe-author">By Chef Mike</div>
                  <div class="recipe-rating">
                    <div class="stars">
                      <i class="fas fa-star"></i>
                      <i class="fas fa-star"></i>
                      <i class="fas fa-star"></i>
                      <i class="fas fa-star"></i>
                      <i class="far fa-star"></i>
                    </div>
                    <span>4.0</span>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <!-- Recent Recipes -->
          <section class="recent-recipes">
            <div class="section-header">
              <h3>Recent Recipes</h3>
              <a href="#">See All <i class="fas fa-chevron-right"></i></a>
            </div>

            <div class="recipe-list">
              <div class="recipe-list-item">
                <div class="recipe-list-image">
                  <img
                    src="https://www.kawalingpinoy.com/wp-content/uploads/2019/03/chicken-afritada-6.jpg"
                    alt="Chicken Afritada"
                  />
                </div>
                <div class="recipe-list-content">
                  <h4>Chicken Afritada</h4>
                  <div class="recipe-list-info">
                    <div class="recipe-list-stats">
                      <span><i class="far fa-clock"></i> 45 min</span>
                      <span><i class="fas fa-fire"></i> 280 Cal</span>
                    </div>
                    <div class="recipe-list-rating">
                      <i class="fas fa-star"></i>
                      <span>4.7</span>
                    </div>
                  </div>
                </div>
                <div class="recipe-list-bookmark">
                  <i class="far fa-bookmark"></i>
                </div>
              </div>

              <div class="recipe-list-item">
                <div class="recipe-list-image">
                  <img
                    src="https://www.foxyfolksy.com/wp-content/uploads/2015/06/pancit-canton.jpg"
                    alt="Pancit Canton"
                  />
                </div>
                <div class="recipe-list-content">
                  <h4>Pancit Canton</h4>
                  <div class="recipe-list-info">
                    <div class="recipe-list-stats">
                      <span><i class="far fa-clock"></i> 30 min</span>
                      <span><i class="fas fa-fire"></i> 320 Cal</span>
                    </div>
                    <div class="recipe-list-rating">
                      <i class="fas fa-star"></i>
                      <span>4.5</span>
                    </div>
                  </div>
                </div>
                <div class="recipe-list-bookmark">
                  <i class="far fa-bookmark"></i>
                </div>
              </div>
            </div>
          </section>
        </div>

        <!-- Generate Tab Content -->
        <div id="tab-generate" class="tab-content">
          <!-- Ingredient Input Section -->
          <section class="ingredient-section">
            <h2 class="section-title">What ingredients do you have?</h2>
            <form id="mobile-ingredient-form" onsubmit="return false;">
              <div class="input-group">
                <input
                  type="text"
                  id="mobile-ingredient-input"
                  class="input"
                  placeholder="Type an ingredient..."
                  autocomplete="off"
                />
                <button
                  id="mobile-add-ingredient"
                  type="button"
                  class="btn btn-primary"
                >
                  Add
                </button>
              </div>
            </form>
            <div class="ingredients-container">
              <ul id="mobile-ingredient-list" class="ingredients-list"></ul>
            </div>
            <button id="mobile-generate-recipe" class="cta w-full mb-md">
              Generate Recipe
            </button>
            <div id="mobile-recipe-result" class="recipe-result"></div>
          </section>
        </div>

        <!-- Community Tab Content -->
        <div id="tab-community" class="tab-content">
          <section class="community-section">
            <h2 class="section-title">Community Recipes</h2>
            <div id="community-feed" class="community-grid">
              <em>Loading community recipes...</em>
            </div>
          </section>
        </div>

        <!-- Profile Tab Content -->
        <div id="tab-profile" class="tab-content">
          <!-- Auth Section -->
          <section class="auth-section">
            <h2 class="section-title">User Account</h2>
            <div id="user-info" class="hidden">
              <!-- User details (username, email) will be populated here by AuthService -->
            </div>

            <section class="profile-picture-section" id="profile-picture-section">
              <h4>Profile Picture</h4>
              <div class="current-avatar-display">
                <!-- Current avatar will be shown by AuthService, this is an additional display spot if needed -->
                <img id="profile-tab-avatar-img" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23eee'/%3E%3Ctext x='50' y='50' font-family='Arial' font-size='50' fill='%23aaa' text-anchor='middle' dy='.3em'%3E%3C/text%3E%3C/svg%3E" alt="Current Avatar" class="profile-avatar-large">
              </div>
              <div class="form-group">
                <label for="profile-image-upload-input" class="sr-only">Upload new profile picture</label>
                <input type="file" id="profile-image-upload-input" accept="image/jpeg, image/png, image/gif" class="hidden">
                <button type="button" id="profile-choose-image-btn" class="btn btn-secondary">Change Picture</button>
                <p class="form-hint">Max 2MB. JPG, PNG, GIF.</p>
              </div>
              <!-- Optional: Cropper modal for profile picture -->
              <div id="profile-cropper-modal" class="cropper-modal hidden">
                <div class="cropper-modal-content">
                  <h4>Crop Your Profile Picture</h4>
                  <div><img id="profile-cropper-image" src="#" class="cropper-image-max" alt="Profile Cropper Preview"></div>
                  <div class="cropper-modal-actions">
                    <button type="button" id="profile-crop-image-btn" class="btn-primary">Crop & Save</button>
                    <button type="button" id="profile-cancel-crop-btn" class="btn-secondary">Cancel</button>
                  </div>
                </div>
              </div>
               <div id="profile-upload-message" class="upload-message"></div>
            </section>

            <div class="auth-forms-container">
              <form id="signup-form" class="auth-form">
                <!-- Username field is dynamically injected via JavaScript -->
                <input
                  type="email"
                  id="signup-email"
                  placeholder="Email"
                  required
                  autocomplete="email"
                />
                <input
                  type="password"
                  id="signup-password"
                  placeholder="Password"
                  required
                  autocomplete="new-password"
                />
                <p class="password-hint">
                  Password must be at least 8 characters with uppercase,
                  lowercase, and numbers
                </p>
                <button type="submit">Sign Up</button>
              </form>

              <form id="login-form" class="auth-form">
                <input
                  type="email"
                  id="login-email"
                  placeholder="Email"
                  required
                  autocomplete="email"
                />
                <input
                  type="password"
                  id="login-password"
                  placeholder="Password"
                  required
                  autocomplete="current-password"
                />
                <button type="submit">Log In</button>
              </form>
            </div>

            <button id="logout-btn" class="hidden">Log Out</button>
            <div id="auth-message" class="auth-message"></div>

            <div class="auth-options">
              <button id="forgot-password-btn" class="text-button">
                Forgot Password?
              </button>
            </div>
          </section>
          <!-- User Recipe Upload Section -->
          <section class="upload-section" id="upload-section">
            <h2>Upload Your Own Recipe</h2>
            <p class="section-description">
              Share your favorite Filipino recipes with our community!
            </p>

            <form id="upload-form" enctype="multipart/form-data">
              <div class="form-group">
                <label for="recipe-name">Recipe Name</label>
                <input
                  type="text"
                  id="recipe-name"
                  placeholder="E.g., Chicken Adobo, Pancit Canton"
                  required
                />
              </div>

              <div class="form-group">
                <label for="recipe-category">Category</label>
                <select id="recipe-category" required>
                  <option value="">Select a category</option>
                  <option value="main">Main Dish</option>
                  <option value="side">Side Dish</option>
                  <option value="dessert">Dessert</option>
                  <option value="appetizer">Appetizer</option>
                  <option value="soup">Soup</option>
                  <option value="breakfast">Breakfast</option>
                  <option value="snack">Snack</option>
                </select>
              </div>

              <div class="form-group">
                <label for="recipe-ingredients">Ingredients</label>
                <textarea
                  id="recipe-ingredients"
                  placeholder="Enter ingredients separated by commas"
                  required
                ></textarea>
                <p class="form-hint">
                  Example: 1 kg chicken, 1/2 cup soy sauce, 1/4 cup vinegar
                </p>
              </div>

              <div class="form-group">
                <label for="recipe-instructions">Cooking Instructions</label>
                <textarea
                  id="recipe-instructions"
                  placeholder="Enter step-by-step instructions"
                  required
                ></textarea>
                <p class="form-hint">
                  Be clear and detailed so others can follow your recipe
                </p>
              </div>

              <div class="form-group">
                <label for="recipe-image">Recipe Photo (Optional)</label>
                <div
                  class="image-upload-container enhanced-upload"
                  id="image-upload-area"
                >
                  <div class="image-preview" id="image-preview">
                    <img
                      id="preview-img"
                      src="#"
                      alt="Preview"
                      title="Recipe Preview"
                      class="hidden"
                    />
                    <span class="preview-text"
                      >Drag & drop or click to select an image</span
                    >
                  </div>
                  <input
                    type="file"
                    id="recipe-image"
                    accept="image/jpeg, image/png, image/gif"
                    class="hidden"
                  />
                  <button
                    type="button"
                    id="choose-image-btn"
                    class="choose-image-btn"
                  >
                    Choose Image
                  </button>
                  <div
                    class="image-upload-progress hidden"
                    id="image-upload-progress"
                  >
                    <div class="progress-bar" id="image-progress-bar"></div>
                  </div>
                  <p class="form-hint">
                    Maximum size: 5MB. Formats: JPG, PNG, GIF
                  </p>
                </div>
                <!-- Cropping Modal -->
                <div id="cropper-modal" class="cropper-modal hidden">
                  <div class="cropper-modal-content">
                    <h4>Crop Your Image</h4>
                    <div>
                      <img
                        id="cropper-image"
                        src="#"
                        class="cropper-image-max"
                        alt="Cropper Preview"
                        title="Cropper Preview"
                      />
                    </div>
                    <div class="cropper-modal-actions">
                      <button
                        type="button"
                        id="crop-image-btn"
                        class="btn-primary"
                      >
                        Crop & Use
                      </button>
                      <button
                        type="button"
                        id="cancel-crop-btn"
                        class="btn-secondary"
                      >
                        Cancel
                      </button>
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-group">
                <label for="recipe-origin">Recipe Origin (Optional)</label>
                <input
                  type="text"
                  id="recipe-origin"
                  placeholder="Family recipe, region, or inspiration"
                />
              </div>

              <div class="form-actions">
                <button type="submit" class="submit-btn">Share Recipe</button>
                <button type="reset" class="reset-btn">Clear Form</button>
              </div>
            </form>

            <div id="upload-message" class="upload-message"></div>
            <div id="upload-progress" class="upload-progress">
              <div class="progress-bar" id="progress-bar"></div>
            </div>
          </section>
        </div>
      </main>

      <!-- Tab Navigation -->
      <nav class="tab-navigation">
        <a href="#" class="tab-item active" data-tab="home">
          <i class="fas fa-home"></i>
          <span>Home</span>
        </a>
        <a href="#" class="tab-item" data-tab="generate">
          <i class="fas fa-magic"></i>
          <span>Generate</span>
        </a>
        <a href="#" class="tab-item" data-tab="community">
          <i class="fas fa-users"></i>
          <span>Community</span>
        </a>
        <a href="#" class="tab-item" data-tab="profile">
          <i class="fas fa-user"></i>
          <span>Profile</span>
        </a>
      </nav>

      <!-- Previous sections removed and integrated into tabbed layout -->

      <!-- Old feature sections removed and incorporated into tabs -->
    </div>

    <!-- Modal Container for Pop-ups -->
    <div id="modal-container" class="modal-container hidden">
      <div class="modal">
        <button class="close-modal">×</button>
        <div id="modal-content"></div>
      </div>
    </div>

    <!-- External libraries loaded after the DOM to prevent render blocking -->
    <script src="https://cdn.jsdelivr.net/npm/cropperjs@1.5.12/dist/cropper.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/cropperjs@1.5.12/dist/cropper.min.css"
    />

    <!-- Application scripts -->
    <script src="env.js"></script>

    <!-- Module imports for our new architecture -->
    <script type="module" src="js/main.js"></script>
    <script type="module" src="js/components/tab-navigation.js"></script>
    <script type="module" src="js/components/recipe-generator.js"></script>
    <script type="module" src="js/components/community-recipes.js"></script>
    <script type="module" src="js/components/file-upload.js"></script>
    <script type="module" src="js/services/api-service.js"></script>
    <script type="module" src="js/services/auth-service.js"></script>
    <script type="module" src="js/utils/validation.js"></script>
    <script type="module" src="js/utils/formatting.js"></script>
  </body>
</html>
